<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer</title>
    <link rel="stylesheet" href="../static/styles.css"
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=restart_alt" />



</head>
<body>
    <div class="pomodoro">
        <div class="timer-type">
            <button id="pomodoro-timer" onclick="setActive(this)">Pomodoro</button>
            <button id="short-break" onclick="setActive(this)">Short Break</button>
            <button id="long-break" onclick="setActive(this)">Long Break</button>
        </div>
        <div class="timer" id="timer">25:00</div>
        <div class="timer-buttons">
            <div class="start-container">
                <button onclick="startTimer()" id="start" class="start">START</button>
            </div>
            <span class="material-symbols-outlined reset-button" id="reset" onclick="resetTimer()">
            restart_alt
            </span>
        </div>
    </div>
    
    <script>
        document.getElementById('pomodoro-timer').classList.add('active');
        const startButton = document.getElementById('start');

        let countdown = document.getElementById('timer');
        let selectedTime = "pomodoro-timer"
        let pomodoroCount = 0;
        let isRunning = false;
        let timeLeft;
        let interval;
        
        const timeMapping = {
                "short-break": 5 * 60,
                "long-break": 15 * 60,
                "pomodoro-timer": 25 * 60,
            };

        function setActive(clickedButton){
            clearInterval(interval);
            startButton.textContent = "START";
            isRunning = false;
            document.querySelectorAll('button').forEach(button => {
                button.classList.remove('active');
            });

            clickedButton.classList.add('active');

            selectedTime = clickedButton.id;
            updateTimerDisplay(timeMapping[selectedTime]);
            timeLeft = timeMapping[selectedTime];
        }

        function updateTimerDisplay(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            countdown.textContent = `${minutes}:${secs.toString().padStart(2, '0')}`
        }

        function startCountdown() {

            clearInterval(interval);

            interval = setInterval (() => {
                timeLeft --;

                updateTimerDisplay(timeLeft);

                if (timeLeft <= 0) {
                    isRunning = false;
                    clearInterval(interval);
                    handleCycle();
                }

            }, 1000);
        }

        function startTimer(){
            if (isRunning) {
                document.getElementById('reset').style.opacity = 0;
                clearInterval(interval);
                startButton.textContent = "START";
                isRunning = false;
            } else {
                if (!timeLeft) {
                    timeLeft = timeMapping[selectedTime];
                }
                isRunning = true;
                startButton.textContent = "PAUSE";
                document.getElementById('reset').style.opacity = 1;
                startCountdown();
            };
        };

        function resetTimer(){
            clearInterval(interval);
            startButton.textContent = "START";
            updateTimerDisplay(timeMapping[selectedTime]);
            timeLeft = timeMapping[selectedTime]
            isRunning = false;
            document.getElementById('reset').style.opacity = 0;
        }


    </script>
</body>
</html>